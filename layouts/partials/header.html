<div id="overlay" onclick="removeHash();"></div>
<div id="side-menu">
  <div class="close" onclick="removeHash();">âœ•</div>
  <div class="menu-container">
    <div class="navigation">
      Menus
      {{ $currentPage := .  }}
      {{ range .Site.Menus.main }}
      <li class="nav-item {{ .Identifier }}">
        <a class="nav-link"
        href="{{ .URL }}">
        {{ .Name }} 
      </a>
      </li>
      {{ end }}
      <a href="#login">login</a>
      <a href="#register">register</a>
    </div>
    <div class="login-container">
      <div class="register">
        <h1>Register</h1>
        <a href="#login">login</a>
      </div>
      <div class="login">
        <h1>Login</h1>
        <a href="#register">register</a>
      </div>
    </div>
  </div>
</div>

<nav class="container">
  <div class="row">
    <div class="col-lg-12">
      <a class="navbar-brand" href="/">
        Dashbirb
      </a>
      {{ range .Site.Menus.main }}
      <a class="d-none d-md-block" href="{{ .URL }}">{{ .Name }}</a>
      {{ end }}
      <a class="d-none d-md-block" href="#login">login</a>
      <a class="d-none d-md-block" href="#register">register</a>
      <a class="d-md-none d-md-none" href="#menu">burger menu</a>
  </div>
</nav>

<style>
  #overlay {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: rgba(0,0,0,0.5);
    z-index: 100;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.6s;
  }
  #overlay.show {
    opacity: 1;
    pointer-events: unset;
  }
  #side-menu {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    width: 20rem;
    margin: .75rem;
    border-radius: 1rem;
    background: white;
    z-index: 101;
    transform: translateX(120%);
    transition: all 0.4s cubic-bezier(0, 0, 0.1, 1);
    overflow: hidden;
    color: black;
  }
  #side-menu.show {
    transform: translateX(0%);
  }
  .close {
    position: absolute;
    top: .5rem;
    right: .5rem;
    z-index: 1;
  }
  .menu-container {
    width: 200%;
    height: 100%;
    display: flex;
    transition: transform .3s;
  }
  #side-menu.menu .menu-container {
    transform: translateX(0%);
  }
  #side-menu .login, #side-menu .register {
    transition: all .3s;
  }
  #side-menu.login .menu-container, #side-menu.register .menu-container {
    transform: translateX(-50%);
  }
  #side-menu.register .login-container .login {
    transform: translateX(-50%);
    opacity: 0;
    pointer-events: none;
  }
  #side-menu.login .login-container .register {
    transform: translateX(50%);
    opacity: 0;
    pointer-events: none;
  }
  .navigation {
    width: 50%;
    height: 100%;
  }
  .login-container {
    width: 50%;
    height: 100%;
    position: relative;
  }
  .register {
    position: absolute;
    width: 100%;
  }
  .login {
    position: absolute;
    width: 100%;
  }
  @media (max-width: 768px) {
    #side-menu {
      margin: 0;
      border-radius: 0;
      width: 100%;
    }
  }
</style>

<script>
  var $sideMenu = document.querySelector('#side-menu')
  var $overlay = document.querySelector('#overlay')
  var hashTriggers = ['#menu', '#login', '#register']
  window.onpopstate = function () {
    const hash = window.location.hash
    if (hashTriggers.find(function (str) {return str === hash})) {
      $sideMenu.className = 'show'
      $overlay.classList.add('show')
      switch (hash) {
        case '#menu':
          $sideMenu.classList.add('menu')
          break
        case '#login':
          $sideMenu.classList.add('login')
          break
        case '#register':
          $sideMenu.classList.add('register')
          break
      }
    } else if (hash === '') {
      $sideMenu.className = ''
      $overlay.className = ''
    }
  }
  function removeHash () {
    var state = ''
    var popStateEvent = new PopStateEvent('popstate', { state: state })
    history.pushState(state, document.title, window.location.pathname + window.location.search)
    dispatchEvent(popStateEvent)
  }
</script>